<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisi di Fattibilità - Progetto Immobiliare Parco Sim</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --secondary: #334155;
            --positive: #10b981;
            --negative: #ef4444;
            --warning: #f59e0b;
            --light-bg: #f1f5f9;
            --border: #e2e8f0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8fafc;
        }
        
        .container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        h1, h2, h3, h4 {
            color: var(--secondary);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        h1 {
            text-align: center;
            color: var(--primary);
            font-size: 2.2rem;
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 10px;
            margin-bottom: 2rem;
        }
        
        h2 {
            color: var(--primary);
            font-size: 1.8rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.95rem;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        th {
            background-color: var(--light-bg);
            font-weight: 600;
        }
        
        tr:hover {
            background-color: #f8fafc;
        }
        
        .summary-box {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 1.5rem 0;
            justify-content: space-between;
        }
        
        .summary-item {
            flex: 1;
            min-width: 200px;
            background-color: var(--light-bg);
            padding: 1.2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .summary-label {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 8px;
            color: var(--secondary);
        }
        
        .summary-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .summary-subtext {
            font-size: 0.85rem;
            color: #64748b;
            margin-top: 5px;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
            margin: 2rem 0;
        }
        
        .tab-container {
            margin: 2rem 0;
        }
        
        .tabs {
            display: flex;
            gap: 2px;
            margin-bottom: 1rem;
        }
        
        .tab-button {
            background-color: var(--light-bg);
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            border-radius: 4px 4px 0 0;
        }
        
        .tab-button.active {
            background-color: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 0 4px 4px 4px;
            border: 1px solid var(--border);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid var(--primary);
        }
        
        .positive {
            color: var(--positive);
        }
        
        .negative {
            color: var(--negative);
        }
        
        .warning {
            color: var(--warning);
        }
        
        .flex-row {
            display: flex;
            gap: 20px;
            margin: 1.5rem 0;
        }
        
        .flex-col {
            flex: 1;
        }
        
        .scenario-selector {
            display: flex;
            gap: 10px;
            margin: 1rem 0;
        }
        
        .scenario-button {
            padding: 8px 16px;
            border: 1px solid var(--primary);
            background-color: white;
            color: var(--primary);
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .scenario-button.active {
            background-color: var(--primary);
            color: white;
        }
        
        .metric-box {
            background-color: var(--light-bg);
            padding: 1.2rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .metric-label {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .metric-value {
            font-size: 1.2rem;
            font-weight: 700;
        }
        
        .metric-box.highlight {
            background-color: #dbeafe;
            border-left: 4px solid var(--primary);
        }
        
        .risk-table td:nth-child(2),
        .risk-table td:nth-child(3) {
            text-align: center;
            font-weight: 600;
        }
        
        .risk-low {
            color: var(--positive);
        }
        
        .risk-medium {
            color: var(--warning);
        }
        
        .risk-high {
            color: var(--negative);
        }
        
        footer {
            margin-top: 3rem;
            text-align: center;
            color: #64748b;
            font-size: 0.9rem;
            padding: 1rem;
            border-top: 1px solid var(--border);
        }
        
        @media (max-width: 768px) {
            .summary-box, .flex-row {
                flex-direction: column;
            }
            
            .summary-item, .flex-col {
                width: 100%;
            }
            
            table {
                font-size: 0.8rem;
            }
            
            th, td {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <h1>Analisi di Fattibilità<br>Progetto Immobiliare Parco Sim</h1>
    
    <div class="container">
        <h2>1. Sintesi dell'Operazione</h2>
        
        <div class="summary-box">
            <div class="summary-item">
                <div class="summary-label">Prezzo di acquisto</div>
                <div class="summary-value">€900.000</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Superficie totale</div>
                <div class="summary-value">728,6 mq</div>
                <div class="summary-subtext">Superficie commerciale: 796,04 mq</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Budget ristrutturazione</div>
                <div class="summary-value">€510.020</div>
                <div class="summary-subtext">€700/mq</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Ricavo previsto</div>
                <div class="summary-value">€2.149.308</div>
                <div class="summary-subtext">€2.700/mq medio</div>
            </div>
        </div>
        
        <div class="summary-box">
            <div class="summary-item">
                <div class="summary-label">Durata operazione</div>
                <div class="summary-value">7-8 mesi</div>
                <div class="summary-subtext">3 mesi ristrutturazione + 4-5 mesi vendita</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Margine lordo</div>
                <div class="summary-value">€614.788</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Utile netto</div>
                <div class="summary-value">€443.262</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">ROI</div>
                <div class="summary-value">28,9%</div>
                <div class="summary-subtext">~43-49% annualizzato</div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <h2>2. Analisi delle Superfici</h2>
        
        <h3>Dettaglio Unità Immobiliari</h3>
        <table>
            <thead>
                <tr>
                    <th>SUB</th>
                    <th>Scala</th>
                    <th>Interno</th>
                    <th>Piano</th>
                    <th>Appartamento (mq)</th>
                    <th>Balconi (mq)</th>
                    <th>Giardino (mq)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>45</td>
                    <td>H</td>
                    <td>1</td>
                    <td>R</td>
                    <td>161,6</td>
                    <td>50,8</td>
                    <td>44,4</td>
                </tr>
                <tr>
                    <td>46</td>
                    <td>H</td>
                    <td>2</td>
                    <td>R</td>
                    <td>131,0</td>
                    <td>33,9</td>
                    <td>35,7</td>
                </tr>
                <tr>
                    <td>47</td>
                    <td>H</td>
                    <td>3</td>
                    <td>1</td>
                    <td>161,6</td>
                    <td>50,8</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>49</td>
                    <td>I</td>
                    <td>1</td>
                    <td>R</td>
                    <td>139,0</td>
                    <td>31,3</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>50</td>
                    <td>I</td>
                    <td>2</td>
                    <td>R</td>
                    <td>135,4</td>
                    <td>31,3</td>
                    <td>-</td>
                </tr>
                <tr style="font-weight: bold; background-color: #f1f5f9;">
                    <td colspan="4">TOTALE</td>
                    <td>728,6</td>
                    <td>198,1</td>
                    <td>80,1</td>
                </tr>
            </tbody>
        </table>
        
        <h3>Superficie Commerciale</h3>
        <div class="card">
            <p>Calcolata considerando:</p>
            <ul>
                <li>100% superficie residenziale</li>
                <li>30% superficie balconi</li>
                <li>10% superficie giardini</li>
            </ul>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th>SUB</th>
                    <th>Appartamento (mq)</th>
                    <th>Balconi (30%)</th>
                    <th>Giardino (10%)</th>
                    <th>Superficie commerciale (mq)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>45</td>
                    <td>161,6</td>
                    <td>15,24</td>
                    <td>4,44</td>
                    <td>181,28</td>
                </tr>
                <tr>
                    <td>46</td>
                    <td>131,0</td>
                    <td>10,17</td>
                    <td>3,57</td>
                    <td>144,74</td>
                </tr>
                <tr>
                    <td>47</td>
                    <td>161,6</td>
                    <td>15,24</td>
                    <td>-</td>
                    <td>176,84</td>
                </tr>
                <tr>
                    <td>49</td>
                    <td>139,0</td>
                    <td>9,39</td>
                    <td>-</td>
                    <td>148,39</td>
                </tr>
                <tr>
                    <td>50</td>
                    <td>135,4</td>
                    <td>9,39</td>
                    <td>-</td>
                    <td>144,79</td>
                </tr>
                <tr style="font-weight: bold; background-color: #f1f5f9;">
                    <td>TOTALE</td>
                    <td>728,6</td>
                    <td>59,43</td>
                    <td>8,01</td>
                    <td>796,04</td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <div class="container">
        <h2>3. Conto Economico</h2>
        
        <div class="scenario-selector">
            <button class="scenario-button active" data-scenario="base">Scenario Base</button>
            <button class="scenario-button" data-scenario="pessimistico">Scenario Pessimistico</button>
            <button class="scenario-button" data-scenario="ottimistico">Scenario Ottimistico</button>
        </div>
        
        <div class="flex-row">
            <div class="flex-col">
                <h3>Costi</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Voce di costo</th>
                            <th>Importo (€)</th>
                            <th>Note</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Acquisto immobili</td>
                            <td>900.000</td>
                            <td>Prezzo concordato</td>
                        </tr>
                        <tr>
                            <td>IVA sull'acquisto</td>
                            <td>90.000</td>
                            <td>10% sul prezzo di acquisto</td>
                        </tr>
                        <tr>
                            <td>Costi notarili</td>
                            <td>10.000</td>
                            <td>Spese per atto notarile</td>
                        </tr>
                        <tr>
                            <td>Ristrutturazione</td>
                            <td>510.020</td>
                            <td>€700/mq × 728,6 mq</td>
                        </tr>
                        <tr>
                            <td>Commissioni agenzie</td>
                            <td>20.000</td>
                            <td>Per la commercializzazione</td>
                        </tr>
                        <tr>
                            <td>Imposte e oneri vari</td>
                            <td>4.500</td>
                            <td>Stima altre imposte</td>
                        </tr>
                        <tr style="font-weight: bold; background-color: #f1f5f9;">
                            <td>TOTALE COSTI</td>
                            <td>1.534.520</td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="flex-col">
                <h3>Ricavi</h3>
                <table class="scenario-table">
                    <thead>
                        <tr>
                            <th>Scenario</th>
                            <th>Prezzo al mq (€)</th>
                            <th>Superficie (mq)</th>
                            <th>Ricavo totale (€)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-scenario="pessimistico">
                            <td>Pessimistico</td>
                            <td>2.500</td>
                            <td>796,04</td>
                            <td>1.990.100</td>
                        </tr>
                        <tr data-scenario="base" style="font-weight: bold; background-color: #dbeafe;">
                            <td>Base</td>
                            <td>2.700</td>
                            <td>796,04</td>
                            <td>2.149.308</td>
                        </tr>
                        <tr data-scenario="ottimistico">
                            <td>Ottimistico</td>
                            <td>3.000</td>
                            <td>796,04</td>
                            <td>2.388.120</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Risultato Economico</h3>
                <div id="risultato-economico">
                    <div class="metric-box highlight">
                        <div class="metric-label">Ricavi totali</div>
                        <div class="metric-value">€2.149.308</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">Costi totali</div>
                        <div class="metric-value">€1.534.520</div>
                    </div>
                    <div class="metric-box highlight">
                        <div class="metric-label">Margine lordo</div>
                        <div class="metric-value">€614.788</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">Imposte (27,9%)</div>
                        <div class="metric-value">€171.526</div>
                    </div>
                    <div class="metric-box highlight">
                        <div class="metric-label">Utile netto</div>
                        <div class="metric-value">€443.262</div>
                    </div>
                    <div class="metric-box highlight">
                        <div class="metric-label">ROI</div>
                        <div class="metric-value">28,9%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <h2>4. Analisi di Sensibilità</h2>
        
        <div class="flex-row">
            <div class="flex-col">
                <h3>Variazione del prezzo di vendita</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Prezzo al mq (€)</th>
                            <th>Ricavo totale (€)</th>
                            <th>Margine lordo (€)</th>
                            <th>Utile netto (€)</th>
                            <th>ROI (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2.500</td>
                            <td>1.990.100</td>
                            <td>455.580</td>
                            <td>328.473</td>
                            <td>21,4%</td>
                        </tr>
                        <tr style="font-weight: bold; background-color: #dbeafe;">
                            <td>2.700</td>
                            <td>2.149.308</td>
                            <td>614.788</td>
                            <td>443.262</td>
                            <td>28,9%</td>
                        </tr>
                        <tr>
                            <td>3.000</td>
                            <td>2.388.120</td>
                            <td>853.600</td>
                            <td>615.446</td>
                            <td>40,1%</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="chart-container">
                    <canvas id="prezzoChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="flex-row">
            <div class="flex-col">
                <h3>Variazione del costo di ristrutturazione</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Costo al mq (€)</th>
                            <th>Costo totale (€)</th>
                            <th>Margine lordo (€)</th>
                            <th>Utile netto (€)</th>
                            <th>ROI (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>650</td>
                            <td>473.590</td>
                            <td>651.218</td>
                            <td>469.528</td>
                            <td>31,6%</td>
                        </tr>
                        <tr style="font-weight: bold; background-color: #dbeafe;">
                            <td>700</td>
                            <td>510.020</td>
                            <td>614.788</td>
                            <td>443.262</td>
                            <td>28,9%</td>
                        </tr>
                        <tr>
                            <td>750</td>
                            <td>546.450</td>
                            <td>578.358</td>
                            <td>416.996</td>
                            <td>26,2%</td>
                        </tr>
                        <tr>
                            <td>800</td>
                            <td>582.880</td>
                            <td>541.928</td>
                            <td>390.730</td>
                            <td>23,8%</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="chart-container">
                    <canvas id="ristrutturazioneCostoChart"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <h2>5. Flusso di Cassa</h2>
        
        <h3>Timeline dell'operazione (8 mesi)</h3>
        <table>
            <thead>
                <tr>
                    <th>Fase</th>
                    <th>Periodo</th>
                    <th>Flusso di cassa</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Acquisto e imposte</td>
                    <td>Mese 1</td>
                    <td class="negative">-€1.000.000</td>
                </tr>
                <tr>
                    <td>Ristrutturazione</td>
                    <td>Mesi 2-4</td>
                    <td class="negative">-€170.007/mese</td>
                </tr>
                <tr>
                    <td>Vendita</td>
                    <td>Mesi 5-8</td>
                    <td class="positive">+€537.327/mese</td>
                </tr>
            </tbody>
        </table>
        
        <div class="chart-container">
            <canvas id="cashFlowChart"></canvas>
        </div>
    </div>
    
    <div class="container">
        <h2>6. Analisi del Punto di Pareggio</h2>
        
        <div class="flex-row">
            <div class="flex-col">
                <h3>Prezzo di vendita minimo</h3>
                <div class="card">
                    <ul>
                        <li><strong>Costi totali:</strong> €1.534.520</li>
                        <li><strong>Superficie commerciale:</strong> 796,04 mq</li>
                        <li><strong>Prezzo di pareggio:</strong> €1.927,70/mq</li>
                        <li><strong>Margine di sicurezza:</strong> 29,7% rispetto al prezzo worst case (€2.500/mq)</li>
                    </ul>
                </div>
                
                <div class="chart-container">
                    <canvas id="breakEvenChart"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <h2>7. Analisi dei Rischi</h2>
        
        <table class="risk-table">
            <thead>
                <tr>
                    <th>Rischio</th>
                    <th>Probabilità</th>
                    <th>Impatto</th>
                    <th>Strategie di mitigazione</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Aumento costi di ristrutturazione</td>
                    <td class="risk-medium">Media</td>
                    <td class="risk-medium">Medio</td>
                    <td>Contratti a prezzo fisso, contingency budget</td>
                </tr>
                <tr>
                    <td>Ritardi nella ristrutturazione</td>
                    <td class="risk-medium">Media</td>
                    <td class="risk-medium">Medio</td>
                    <td>Penali nei contratti, pianificazione buffer</td>
                </tr>
                <tr>
                    <td>Difficoltà di vendita</td>
                    <td class="risk-low">Bassa</td>
                    <td class="risk-high">Alto</td>
                    <td>Marketing mirato, possibilità di vendita sulla carta</td>
                </tr>
                <tr>
                    <td>Calo dei prezzi di mercato</td>
                    <td class="risk-low">Bassa</td>
                    <td class="risk-high">Alto</td>
                    <td>Margine di sicurezza elevato, flessibilità su prezzo</td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <div class="container">
        <h2>8. Conclusioni e Raccomandazioni</h2>
        
        <h3>Indicatori di fattibilità</h3>
        <div class="summary-box">
            <div class="summary-item">
                <div class="summary-label">Return on Investment</div>
                <div class="summary-value">28,9%</div>
                <div class="summary-subtext">43-49% annualizzato</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Durata</div>
                <div class="summary-value">7-8 mesi</div>
            </div>
            <div class="summary-item">
                <div class="summary-label">Margine di sicurezza</div>
                <div class="summary-value">29,7%</div>
                <div class="summary-subtext">sul prezzo di vendita</div>
            </div>
        </div>
        
        <h3>Raccomandazioni</h3>
        <ol>
            <li><strong>Procedere con l'operazione:</strong> Gli indicatori economici mostrano una redditività interessante con un buon margine di sicurezza.</li>
            <li><strong>Contratti di ristrutturazione:</strong> Stipulare contratti a prezzo fisso per limitare il rischio di aumento costi.</li>
            <li><strong>Strategia di vendita:</strong> Considerare la possibilità di iniziare la commercializzazione già durante la fase di ristrutturazione.</li>
            <li><strong>Differenziazione:</strong> Valutare una strategia di pricing differenziata per le unità con giardino e quelle al primo piano.</li>
        </ol>
        
        <div class="card" style="margin-top: 2rem;">
            <p style="font-weight: 600; font-size: 1.1rem;">
                L'operazione presenta un profilo rischio/rendimento favorevole, con un ROI atteso del 28,9% su un periodo di 7-8 mesi, equivalente a un rendimento annualizzato di circa il 43-49%.
            </p>
        </div>
    </div>
    
    <script>
        // Dati scenari
        const scenariData = {
            pessimistico: {
                prezzoMq: 2500,
                ricavoTotale: 1990100,
                margineLordo: 455580,
                utileNetto: 328473,
                roi: 21.4
            },
            base: {
                prezzoMq: 2700,
                ricavoTotale: 2149308,
                margineLordo: 614788,
                utileNetto: 443262,
                roi: 28.9
            },
            ottimistico: {
                prezzoMq: 3000,
                ricavoTotale: 2388120,
                margineLordo: 853600,
                utileNetto: 615446,
                roi: 40.1
            }
        };
        
        // Funzione per formattare i numeri come valuta
        function formatCurrency(amount) {
            return new Intl.NumberFormat('it-IT', { style: 'currency', currency: 'EUR' }).format(amount);
        }
        
        // Funzione per aggiornare i risultati economici in base allo scenario
        function updateRisultatoEconomico(scenario) {
            const data = scenariData[scenario];
            const risultatoEconomico = document.getElementById('risultato-economico');
            const metrics = risultatoEconomico.querySelectorAll('.metric-value');
            
            metrics[0].textContent = formatCurrency(data.ricavoTotale);
            metrics[2].textContent = formatCurrency(data.margineLordo);
            const imposte = data.margineLordo * 0.279;
            metrics[3].textContent = formatCurrency(imposte);
            metrics[4].textContent = formatCurrency(data.utileNetto);
            metrics[5].textContent = data.roi + '%';
        }
        
        // Gestione pulsanti scenario
        const scenarioButtons = document.querySelectorAll('.scenario-button');
        scenarioButtons.forEach(button => {
            button.addEventListener('click', () => {
                scenarioButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const scenario = button.getAttribute('data-scenario');
                updateRisultatoEconomico(scenario);
                
                // Evidenzia la riga nella tabella degli scenari
                const scenarioRows = document.querySelectorAll('.scenario-table tbody tr');
                scenarioRows.forEach(row => {
                    if (row.getAttribute('data-scenario') === scenario) {
                        row.style.fontWeight = 'bold';
                        row.style.backgroundColor = '#dbeafe';
                    } else {
                        row.style.fontWeight = 'normal';
                        row.style.backgroundColor = '';
                    }
                });
            });
        });
        
        // Grafici
        window.onload = function() {
            // Grafico prezzi vendita
            const ctxPrezzo = document.getElementById('prezzoChart').getContext('2d');
            const prezzoChart = new Chart(ctxPrezzo, {
                type: 'bar',
                data: {
                    labels: ['€2.500/mq', '€2.700/mq', '€3.000/mq'],
                    datasets: [{
                        label: 'ROI (%)',
                        data: [21.4, 28.9, 40.1],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.5)',
                            'rgba(16, 185, 129, 0.5)',
                            'rgba(59, 130, 246, 0.5)'
                        ],
                        borderColor: [
                            'rgb(37, 99, 235)',
                            'rgb(5, 150, 105)',
                            'rgb(37, 99, 235)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Impatto del prezzo di vendita sul ROI',
                            font: {
                                size: 16
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'ROI (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Prezzo di vendita al mq'
                            }
                        }
                    }
                }
            });
            
            // Grafico costi ristrutturazione
            const ctxRistrutturazione = document.getElementById('ristrutturazioneCostoChart').getContext('2d');
            const ristrutturazioneCostoChart = new Chart(ctxRistrutturazione, {
                type: 'line',
                data: {
                    labels: ['€650/mq', '€700/mq', '€750/mq', '€800/mq'],
                    datasets: [{
                        label: 'ROI (%)',
                        data: [31.6, 28.9, 26.2, 23.8],
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderColor: 'rgb(37, 99, 235)',
                        borderWidth: 2,
                        tension: 0.1,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Impatto del costo di ristrutturazione sul ROI',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 20,
                            title: {
                                display: true,
                                text: 'ROI (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Costo ristrutturazione al mq'
                            }
                        }
                    }
                }
            });
            
            // Grafico flusso di cassa
            const ctxCashFlow = document.getElementById('cashFlowChart').getContext('2d');
            const cashFlowData = [
                -1000000,
                -1170007,
                -1340014,
                -1510021,
                -972694,
                -435367,
                101960,
                639287
            ];
            
            const cashFlowChart = new Chart(ctxCashFlow, {
                type: 'line',
                data: {
                    labels: ['Mese 1', 'Mese 2', 'Mese 3', 'Mese 4', 'Mese 5', 'Mese 6', 'Mese 7', 'Mese 8'],
                    datasets: [{
                        label: 'Flusso cumulativo (€)',
                        data: cashFlowData,
                        backgroundColor: function(context) {
                            const value = context.dataset.data[context.dataIndex];
                            return value < 0 ? 'rgba(239, 68, 68, 0.2)' : 'rgba(16, 185, 129, 0.2)';
                        },
                        borderColor: function(context) {
                            const value = context.dataset.data[context.dataIndex];
                            return value < 0 ? 'rgb(220, 38, 38)' : 'rgb(5, 150, 105)';
                        },
                        borderWidth: 2,
                        tension: 0.1,
                        fill: true,
                        pointBackgroundColor: function(context) {
                            const value = context.dataset.data[context.dataIndex];
                            return value < 0 ? 'rgb(220, 38, 38)' : 'rgb(5, 150, 105)';
                        }
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Flusso di cassa cumulativo',
                            font: {
                                size: 16
                            }
                        },
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    yMin: 0,
                                    yMax: 0,
                                    borderColor: 'rgb(75, 85, 99)',
                                    borderWidth: 1,
                                    borderDash: [5, 5]
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Euro (€)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Periodo'
                            }
                        }
                    }
                }
            });
            
            // Grafico punto di pareggio
            const ctxBreakEven = document.getElementById('breakEvenChart').getContext('2d');
            const breakEvenChart = new Chart(ctxBreakEven, {
                type: 'bar',
                data: {
                    labels: ['Prezzo di pareggio', 'Prezzo worst case', 'Prezzo base', 'Prezzo best case'],
                    datasets: [{
                        label: 'Prezzo al mq (€)',
                        data: [1927.70, 2500, 2700, 3000],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.5)',
                            'rgba(245, 158, 11, 0.5)',
                            'rgba(16, 185, 129, 0.5)',
                            'rgba(59, 130, 246, 0.5)'
                        ],
                        borderColor: [
                            'rgb(220, 38, 38)',
                            'rgb(217, 119, 6)',
                            'rgb(5, 150, 105)',
                            'rgb(37, 99, 235)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Analisi del punto di pareggio',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Prezzo al mq (€)'
                            }
                        }
                    }
                }
            });
        };
    </script>
    
    <footer>
        <p>Analisi di Fattibilità - Progetto Immobiliare Parco Sim - San Giorgio</p>
        <p>Ultima modifica: 13 marzo 2025</p>
    </footer>
</body>
</html>
